<!DOCTYPE html>
<html>
<title>Top 15 Olympic Participant Visualization</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<script src='https://d3js.org/d3.v5.min.js'></script>
<script src='https://d3js.org/d3.v5.js'></script>
<style>
    body,h1,h2,h3,h4,h5 {font-family: "Raleway", sans-serif}
    .country {
     fill: #ccc;
     stroke: #fe6;
     stroke-width: .5px;
     stroke-linejoin: round;
    }

    div.tooltip {
      color: #222;
      background: #fff;
      padding: .5em;
      text-shadow: #f5f5f5 0 1px 0;
      border-radius: 2px;
      box-shadow: 0px 0px 2px 0px #a6a6a6;
      opacity: 0.9;
      position: absolute;
    }

    .line {
      fill: none;
      stroke: steelblue;
      stroke-width: 2px;
    }

  .multiLineChart {
      width: 100%;
      height: 100%;
      position: absolute;
    }
</style>
<body class="w3-light-grey" onload="init()">

<div class="w3-content" style="max-width:1400px">

<header class="w3-container w3-center w3-padding-32">
 <h1 style="font-size:60px"><b>Medal Based Analysis By Top 15 Countries</b></h1>
 <p style="font-size:35px">Medal Distribution for Top 15 Olympic participating countries</p>

 <!-- Header -->
<header id="portfolio">
  <a href="#"></a>
  <span class="w3-button w3-hide-large w3-xxlarge w3-hover-text-grey" onclick="w3_open()"><i class="fa fa-bars"></i></span>
  <div class="w3-container">
  <h2><b>Olympic Medal Lookout Tower</b></h2>
  <div class="w3-section w3-bottombar w3-padding-16">
    <span class="w3-margin-right">Look For:</span>
    <a href="https://trupthi-developer.github.io/NarrativeVisualization/" class="w3-button w3-white">Overview</a>
    <a href="https://trupthi-developer.github.io/NarrativeVisualization/participationAnalysisByTop15Countries.html" class="w3-button w3-white"></i>Top Participation by Country</a>
    <button class="w3-button w3-black w3-hide-small"><i class="medalsByCountry"></i>Medals by Country</a>
  </div>
  </div>
</header>

</header>
<!-- Grid -->
<div class="w3-row">
  <div class="w3-col l150 s85">
    <!-- Blog entry -->
    <div class="w3-card-4 w3-margin w3-white">
      <div class="w3-container">
        <h3><b>Top 15 Olympic Participants' Medal distribution Over Years</b></h3>
        <h5>Medal growth over, <span class="w3-opacity">100 years</span></h5>
      </div>

      <div class="w3-container">
        <div class="w3-row">
          <div class="w3-row m8 s12">
              <p>From the previous navigations, we have gained our insight on country's participation in Events, Sport and Gender based distinction. Now lets, dig deep into the Olympic Medal distributions.
               </p>
              <p> The visualization below gives Total Olympic medal obtained by the top 15 countries over the 100+ years. Since the participations across years 1900 - 1990,
              it can be viewed that the total medal trends have been pretty variant in terms of countries that led high in the rank and as the year pass by, post 1990 the trend of the participating countries are a bit predictable.
              Countries like United States, France and Great Britain were high medal winners, as years pass by United states stays in the lead and continues to keep that trend active, as of 2016.
              And most of the other countries follow the same trend.
             </p>
             <p> Also to note, this is a total medal count, including Summer and Winter Events. Hence in the year range between 1990 - 2016, we can see some dips indicating that we had Winter Olympics in those time slots, showing less participations hence less medal counts
                 As mentioned, USA's medal tally remained consistent over the years, but if you notice the Trend in 1977, Germany overtook USA's medal tally making them a great competitor.
             </p>
             <p> Mouseover the lines to see the various countries and their medal counts over the years
             </p>
              <div id="OverallMedalDistributionOverOlympics"  class="w3-col l16 s12">
              </div>
              </div>
          </div>
        </div>
      </div>
    </div>

    <hr>
    <div class="w3-row">
    <!-- Blog entry -->
    <div class="w3-card-4 w3-margin w3-white">

      <div id="Country Based Distribution" class="w3-container">
        <h3><b>Country Based Medal Analysis</b></h3>
        <h5>Top 3 Sports these countries participated in Olympics, <span class="w3-opacity">As of 2016</span></h5>
      </div>

      <div class="w3-container">
        <h3>Medal Distribution Chart</h3>
        <p>In the above multiline chart we visualized how the total medals achieved by each country varied over the timeline of 100+ years.
          In the below medal tally dashboard, we can explore each countries' Overall Medal distribution of Gold, Silver and Bronze till date.
          Along with the sorting of the medals between Gold, Silver and Bronze, we can also know which sport was enabling country to acheive its landmark.
        </p>
        <p> To understand that I have picked top 3 Sport events, the countries got medals in and understand the ratios of Gold, Silver and Bronze medals they acheived.
            One initial load the Medal distribution chart is showing for Australia. Use the drop down to choose the country to view overall medal tallies
            And further on that's countries selection, choose between one of the top 3 sport to see the medal tally for that sport for that country.
        </p>

        <div id="Medal Report" class="w3-col m8 s12">
          <!-- Initialize a select button -->
          <select id="selectCountry" class="w3-col l5 s22">Choose Country</select>
           <div id="MedalBoard" class="w3-row">
                <div id="Top3SportByCountryMedalStats" class="">
                </div>
           </div>
             <div id="Top3BySport" class ="w3-cell-row" style="width:105%">
                   <div id="Top3SportByCountryFullStats" class="w3-row w3-cell" align="end">

                    <h3 align="right"> Top 3 Sport Medal distribution</h3>
                    <!-- Initialize a select button -->
                    <select id="selectTop3Sport">Choose Sport</select>
                    </div>
                    <div id="pieChartLayoutTop3SportMedal" class="w3-container w3-cell ">
                    </div>
             <div>
        </div>
        </div>
        <div class="w3-row">
        </div>
      </div>
    </div>

  <!-- END BLOG ENTRIES -->
  </div>

  <!-- Introduction menu -->
  <div class="w3-col l4">
    <!-- About Card -->
    <div class="w3-card w3-margin w3-margin-top">
    <div class="w3-container w3-white">
    </div>
  </div><hr>


  <script type="text/javascript">
    function init () {
      var showMultiline = countryMedalDistributionLineChart();
      //document.getElementId("OverallCountryMedalStats")delay(1000).fadeIn(1000);
     }


    async function countryMedalDistributionLineChart() {
      // Define margins
     var margin = { top: 20, right: 80, bottom: 30, left: 50 },
         width = 1200 - margin.left - margin.right,
         height = 400 - margin.top - margin.bottom;

     // Define date parser
     var parseDate = d3.timeParse("%Y-%m-%d %H:%M:%S");

     // Define scales
     var xScale = d3.scaleLinear().range([0, width]);
     var yScale = d3.scaleLinear().range([height, 0]);
     var color = d3.scaleOrdinal().range(["#ff9da7","#9c755f","#bab0ab","#8000ff","#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff0066","#77ff33","#0000e6","#ff0000"]);

     // Define axes
     var xAxis = d3.axisBottom().scale(xScale);
     var yAxis = d3.axisLeft().scale(yScale);


     // Define lines
     var line = d3
       .line()
       .curve(d3.curveMonotoneX)
       .x(function(d) {
         return xScale(d["Year"]);
       })
       .y(function(d) {
         return yScale(d["medalsWon"]);
       });
     // Define svg canvas
     var svg =  d3.selectAll("#OverallMedalDistributionOverOlympics")
                       .append("svg").attr("id","multiLineChart")
                       .attr("width", width + margin.left + margin.right)
                       .attr("height", height + margin.top + margin.bottom)
                       .append("g")
                       .attr("transform", `translate(${margin.left} ,${margin.bottom-margin.top} )`);

                // Read in data
     const TotalMedalDistributionByCountry = await d3.csv("https://raw.githubusercontent.com/Trupthi-developer/NarrativeVisualization/master/MedalDistributionOverYearByCountry.csv");

     //Get the color ranges
     var categoryByName = d3.keys(TotalMedalDistributionByCountry[0]).filter(function(key) {
         return key !== "Year";
       });
     color.domain(categoryByName);


     var legend = svg => {
                             const g = svg.attr("transform", `translate(${width-10},1)`)
                                 .attr("text-anchor", "end")
                                 .attr("font-family", "sans-serif")
                                 .attr("font-size", 10)
                               .selectAll("g")
                               .attr("class","colorLegend")
                               .data(color.domain().slice().reverse())
                               .join("g")
                                 .attr("transform", (d, i) => `translate(10,${i * 20})`);

                             g.append("rect")
                                 .attr("x", -19)
                                 .attr("width", 19)
                                 .attr("height", 19)
                                 .attr("fill", color);

                             g.append("text")
                                 .attr("x", 45)
                                 .attr("y", 9.5)
                                 .attr("dy", "0.55em")
                                 .text(d=>d);
                           }



     year1900To1932 = [1900,1904,1906,1912,1920,1924,1928,1932];
     year1936To1972 = [1936,1948,1952,1956,1960,1964,1968,1972];
     year1976To1998 = [1976,1980,1984,1984,1988,1992,1994,1996,1998];
     year2000To2016 = [2000,2002,2004,2006,2008,2010,2012,2014,2016];

     var dataFrom1900To1932 = TotalMedalDistributionByCountry.filter(function(d){ return year1900To1932.indexOf(+d.Year) >= 0 });
     var dataFrom1936To1972 = TotalMedalDistributionByCountry.filter(function(d){ return year1976To1998.indexOf(+d.Year) >= 0 });
     var dataFrom1976To1998 = TotalMedalDistributionByCountry.filter(function(d){ return year1976To1998.indexOf(+d.Year) >= 0  });
     var dataFrom2000To2016 = TotalMedalDistributionByCountry.filter(function(d){ return year2000To2016.indexOf(+d.Year) >= 0  });

    //Build Multiline Chart
            { // Set the color domain equal to the coutnries

                var concentrations= categoryByName.map(function(category) {
                              return {
                                category: category,
                                datapoints: TotalMedalDistributionByCountry.map(function(d) {
                                //dataFrom2000To2016.map(function(d) {
                                  return { Year: d["Year"], medalsWon: +d[category] };
                                })
                              };
                            });


                // Create a tooltip
                // ----------------
                var tooltip = d3.select("#OverallMedalDistributionOverOlympics")
                                .append("div")
                                .attr("class", "tooltip")
                                .style("display","none");

                // Three function that change the tooltip when user hover / move / leave a cell
                var linemouseover = function(d) {
                  var Country = d.category;
                  var lineData = d.datapoints;

                  const mouse = d3.mouse(this);

                  const xm = xScale.invert(mouse[0]).toPrecision(4);
                  const ym = yScale.invert(mouse[1])

                  const yVal = (ym.toPrecision(3) < 100) ? ( ( ym.toPrecision(3) < 10) ? ( (ym.toPrecision(3)<1)? 0 :ym.toPrecision(1)):ym.toPrecision(2) ): ym.toPrecision(3);

                  //console.log(data);
                    tooltip
                      .attr("style", "left:"+(event.pageX)+"px;top:"+event.pageY+"px")
                      .style("display","inline-block")
                      .style("opacity", 1)
                      .style("cursor","pointer")
                      .html("<strong>Country: " + d.category + "</strong><br><strong>Year</strong><span class='details'>" + xm + "<br></span><strong>Number of Medals: </strong><span class='details'>" + yVal + "<br></span>")
                    }
                var linemouseleave = function(d) {
                  tooltip
                    .style("opacity", 0)
                    .style("display","none")
                }
                // Set the domain of the axes
                xScale.domain([1900,2016]);
                  //d3.extent(TotalMedalDistributionByCountry, function(d) {  return +d.Year;}));

                yScale.domain([0, 400])
                // Place the axes on the chart


                svg.append("g")
                  .attr("class", "x axis")
                  .attr("transform", "translate(0," + height + ")")
                  .call(xAxis);

                svg.append("g")
                  .attr("class", "y axis")
                  .call(yAxis)
                  .append("text")
                  .attr("class", "label")
                  .attr("y", 6)
                  .attr("dy", ".71em")
                  .attr("dx", ".71em")
                  .style("text-anchor", "beginning")
                  .text("Total TotalMedalDistributionByCountry");


              svg.selectAll("#multiLineChart")
                    .enter()
                    .append("g")
                    .attr("fill", "none")
                    .attr("stroke", "steelblue")
                    .attr("stroke-width", 1.5)
                    .attr("stroke-linejoin", "round")
                    .attr("stroke-linecap", "round")
                    .attr("class", "category")
                    .data(concentrations)
                      .enter()
                      .append("path")
                      .attr("class", "line")
                      .attr("d", function(d) { return line(d.datapoints);
                        })
                        .style("stroke", function(d) {
                          return color(d.category);
                        })
                    .on("mouseover", linemouseover)
                    .on("mouseleave", linemouseleave)

                //Add label for x-axis
                // text label for the x axis

                svg.append("text")
                    .attr("class", "Linex-axisLabel")
                    .attr("transform",
                          "translate(" + (width - 500) + " ," +
                                         (height + margin.top+ 20) + ")")
                    .style("text-anchor", "middle")
                    .style("font-size","20px")
                    .text("Year");

                // text label for the y axis
                svg.append("text")
                    .attr("class", "Liney-axisLabel")
                    .attr("transform", "rotate(-90)")
                    .attr("y", 0 - margin.left)
                    .attr("x",0 - (height/2))
                    .attr("dy", "1em")
                    .style("text-anchor", "middle")
                    .text("Total Medals");

                svg.append("g")
                    .attr("class","legend")
                    .call(legend);
              }

              // Define responsive behavior
              function resize() {
                var width =
                     parseInt(d3.select("#multiLineChart").style("width")) - margin.left - margin.right,
                  height =
                    parseInt(d3.select("#multiLineChart").style("height")) - margin.top - margin.bottom;

                // Update the range of the scale with new width/height
                xScale.range([0, width]);
                yScale.range([height, 0]);

               // Place the axes on the chart

                // Update the axis and text with the new scale
                svg.select(".x.axis")
                  .attr("transform", "translate(0," + height + ")")
                  .call(xAxis);

                svg.select(".y.axis").call(yAxis);

                // Force D3 to recalculate and update the line
                svg.selectAll(".line").attr("d", function(d) {
                  return line(d.datapoints);
                });

                // Update the tick marks
                xAxis.ticks(Math.max(width / 75, 2));
                yAxis.ticks(Math.max(height / 50, 2));
              }

              // Call the resize function whenever a resize event occurs
              d3.select(window).on("resize", resize);
                resize();
  }
  </script>


  <script type="text/javascript"  id="dashboardFunction">

    async function dashboard(CountryValue){
          const TotalMedalDistributionByCountry = await d3.csv("https://raw.githubusercontent.com/Trupthi-developer/NarrativeVisualization/master/Top15CountriesTotalMedalData.csv");
          const Top3SportMedalDistributionByCountry = await d3.csv("https://raw.githubusercontent.com/Trupthi-developer/NarrativeVisualization/assignmentUIUC/Top3SportByCountryMedalDistribution.csv");
          const Top3SportGenderMedalDistributionByCountry = await d3.csv("https://raw.githubusercontent.com/Trupthi-developer/NarrativeVisualization/master/Top3SportByCountryGenderMedalDistribution.csv");



          var dataForTotalMedals = TotalMedalDistributionByCountry.filter(function(data){ return data.Country == CountryValue; });
          var dataForTop3SportMedals = Top3SportMedalDistributionByCountry.filter(function(data){ return data.Country == CountryValue; });
          var dataForTop3SportGenderMedals = Top3SportGenderMedalDistributionByCountry.filter(function(data){ return data.Country == CountryValue; });

          //Total Medals
          var totalGoldMedal = dataForTotalMedals.map(function(data){return data.GoldTotal});
          var totalSilverMedal = dataForTotalMedals.map(function(data){return data.SilverTotal});
          var totalBronzeMedal = dataForTotalMedals.map(function(data){return data.BronzeTotal});

    {
          var margin = { top: 20, right: 80, bottom: 30, left: 50 },
            width = 850 - margin.left - margin.right,
            height = 270 - margin.top - margin.bottom;

          var svg =  d3.selectAll("#MedalBoard")
                            .append("svg").attr("id","OverallDashboard")
                            .attr("width", width + margin.left + margin.right)
                            .attr("height", height + margin.top + margin.bottom)
                            .append("g")
                            .attr("transform", "translate(" + margin.right + "," + margin.bottom + ")");


            //Draw a rectangle
            var rectangle = svg.append("rect")
                               .attr("class","medalslots")
                           rectangle.attr('x', 0)
                           .attr('y', 10)
                           .attr('width', width)
                           .attr('height',height)
                           .attr('stroke', 'white')
                           .attr('fill', '#fffbe6')
                           .style("stroke", "rgba(35, 31, 32, 0.1)")
                           .style("stroke-width", 8);

                goldmedalGroup = svg.append("g")
                                .attr("class","groupForMedals")
                                .attr("transform", "translate(0," + margin.right + ")")
                                .append("circle")
                                   .attr("class","goldMedalCircle")
                                   .attr('cx', 115)
                                   .attr('cy', 45)
                                   .attr('r', 100)
                                   .attr('stroke', 'white')
                                   .attr('fill', '#ffd500')
                                   .style("stroke", "rgba(35, 31, 32, 0.1)")
                                   .style("stroke-width", 8);

                 silvermedalGroup = svg.selectAll(".groupForMedals").append("circle")
                                     .attr("class","silverMedalCircle")
                                     .attr('cx', 350)
                                     .attr('cy', 45)
                                     .attr('r', 100)
                                     .attr('stroke', 'white')
                                     .attr('fill', '#c0c0c0')
                                     .style("stroke", "rgba(35, 31, 32, 0.1)")
                                     .style("stroke-width", 8);

                bronzemedalGroup = svg.select(".groupForMedals").append("circle")
                                      .attr("class","bronzeMedalCircle")
                                      .attr('cx', 600)
                                      .attr('cy', 45)
                                      .attr('r', 100)
                                      .attr('stroke', 'white')
                                      .attr('fill', '#bf8040')
                                      .style("stroke", "rgba(35, 31, 32, 0.1)")
                                      .style("stroke-width", 8);

                var circleData = [
                           { "Gold": totalGoldMedal, "cx": 115, "cy": 45, "radius": 100},
                           { "Silver": totalSilverMedal,"cx": 350, "cy": 45, "radius": 100},
                           { "Bronze": totalBronzeMedal,"cx": 600, "cy": 45, "radius": 100}];

                 var medalText = svg.append("g")
                                     .attr("class","textForMedals")
                                     .attr("transform", "translate(" + margin.bottom+ "," + margin.right + ")")
                                     .selectAll("text")
                                        .data(circleData)
                                        .enter()
                                        .append("text")
                                         .attr("x", function(d) { return d.cx-90; })
                                         .attr("y", function(d) { return d.cy+10; })
                                         .text( function (d) {
                                                     return ((d.cx == "115" || d.cx == "350")?
                                                               ((d.cx=="115")? ` Gold-${d.Gold}` : ` Silver-${d.Silver}`) : `Bronze-${d.Bronze}` ); })
                                         .attr("font-size", "25px")
                                         .attr("fill", "black")
                                         .attr("align","middle");
      }
            ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

      {
            // set the dimensions and margins of the graph
            var margin = {top: 30, right: 30, bottom: 70, left: 60},
                width = 460 - margin.left - margin.right,
                height = 450 - margin.top - margin.bottom;

            var myGroups = ["Athletics","Basketball","Canoeing","Cross Country Skiing","Cycling","Diving","Fencing","Gymnastics","Handball","Hockey","Ice Hockey","Rowing","Sailing","Swimming","Speed Skating","Table Tennis","Volleyball","Water Polo"];

            var myColorGrp = dataForTop3SportMedals.map(function(d){return d.Sport;});

            var maxSportTotal = d3.max(dataForTop3SportMedals,function(d){return +d.Total;}) ;
            // color palette
            var color = d3.scaleOrdinal()
              .domain(myColorGrp)
              .range(d3.schemeSet3)

            // append the svg object to the body of the page
            var svg = d3.select("#Top3SportByCountryFullStats")
                        .append("svg")
                          .attr("class","Top3SportDashboard")
                          .attr("width", width + margin.left + margin.right)
                          .attr("height", height + margin.top + margin.bottom)
                        .append("g")
                          .attr("class","groupTop3SportByCountry")
                          .attr("transform",
                                "translate(" + margin.left + "," + margin.top + ")");

            // Create a tooltip
            // ----------------
            var tooltip = d3.select("#Top3SportByCountryFullStats")
                            .append("div")
                            .attr("class", "tooltip")
                            .style("display","none");

            // Three function that change the tooltip when user hover / move / leave a cell
            var mouseover = function(d) {
              var sportName = d.Sport;
              var totalMedalValue = d.Total;
              tooltip
                      .attr("style", "left:"+(event.pageX)+"px;top:"+event.pageY+"px")
                      .style("display","inline-block")
                      .style("opacity", 1)
                      .style("cursor","pointer")
                      .html("Sport: " + sportName + "<br>" + "NoOfMedals: " + totalMedalValue)
                }
            var mouseleave = function(d) {
              tooltip
                .style("opacity", 0)
                .style("display","none")
            }

              // X axis
              var x = d3.scaleBand()
                .range([ 0, width ])
                .domain(dataForTop3SportMedals.map(function(d) { return d.Sport; }))
                .padding(0.2);

              svg.append("g")
                .attr("class","groupXAxis")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x))
                .selectAll("text")
                  .attr("transform", "translate(-10,0)rotate(-25)")
                  .style("text-anchor", "end");

              // Add Y axis
              var y = d3.scaleLinear()
                .domain([0, maxSportTotal])
                .range([ height, 0]);
              svg.append("g")
                .call(d3.axisLeft(y));

              // Bars
              svg.selectAll("groupTop3SportByCountry")
                .attr("class","groupSportChart")
                .data(dataForTop3SportMedals)
                .enter()
                .append("rect")
                  .attr("class","groupSportBar")
                  .attr("x", function(d) { return x(d.Sport); })
                  .attr("y", function(d) { return y(d.Total); })
                  .attr("width", x.bandwidth())
                  .attr("height", function(d) { return height - y(d.Total); })
                  .attr("fill",  function(d) { return color(d.Sport); })
                  .on("mouseover", mouseover)
                  .on("mouseleave", mouseleave)


            //Add label for x-axis
            // text label for the x axis

            svg.append("text")
                .attr("class", "groupx-axisLabel")
                .attr("transform",
                      "translate(" + (width - 20) + " ," +
                                     (height + margin.top+ 10) + ")")
                .style("text-anchor", "end")
                .style("font-size","20px")
                .text("Sport");

            // text label for the y axis
            svg.append("text")
                .attr("class", "groupy-axisLabel")
                .attr("transform", "rotate(-90)")
                .attr("y", 0 - margin.left)
                .attr("x",0 - (height/2))
                .attr("dy", "1em")
                .style("text-anchor", "middle")
                .text("Total Medals");

        }
        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        {
          // set the dimensions and margins of the graph
          // The radius of the pieplot is half the width or half the height (smallest one).
            var radius = 150;

            // append the svg object to the div called 'my_dataviz'
            var svgPie = d3.selectAll("#pieChartLayoutTop3SportMedal")
                        .append("svg")
                          .attr("class","top3SportMedalSvg")
                          .attr("width", width + margin.left + margin.right)
                          .attr("height", height + margin.top + margin.bottom)
                        .append("g")
                          .attr("class","top3SportMedalGroup")
                          .attr("transform",
                                `translate(${width - margin.left -margin.bottom}, ${height - margin.left} )`);


            var sportList = dataForTop3SportMedals.map(d=>d.Sport);

            console.log(sportList);

            // set the color scale
            var color = d3.scaleOrdinal()
              .domain(["Gold", "Silver", "Bronze"])
              .range(["#ffd500","#c0c0c0","#bf8040"]);

            //A function that create / update the plot for a given variable:
            var update = function(sport) {

              //var firstSport = dataForTop3SportMedals.filter(function(d,i){if(i == 0) {return d;}})
              //var secSport = dataForTop3SportMedals.filter(function(d,i){if(i == 1) {return d;}})
              //var thirdSport = dataForTop3SportMedals.filter(function(d,i){if(i == 2) {return d;}})

              var sport = dataForTop3SportMedals.filter(function(d){return d.Sport == sport});
              console.log(sport)
              const data = (({ Gold, Silver, Bronze }) => ({ Gold, Silver, Bronze }))(sport[0]);

              console.log(data)
              // Compute the position of each group on the pie:
              var pie = d3.pie()
                .value(function(d) {return d.value; })

              var data_ready = pie(d3.entries(data))
              var arcGenerator = d3.arc()
                  .innerRadius(0)
                  .outerRadius(radius)

              console.log(data_ready)
              // map to data
              var u = svgPie.selectAll("mychart")
                .data(data_ready)

              // Build the pie chart: Basically, each part of the pie is a path that we build using the arc function.
              u
                .enter()
                .append('path')
                .merge(u)
                .transition()
                .duration(1000)
                .attr('d', arcGenerator)
                .attr('fill', function(d){ return(color(d.data.key)) })
                .attr("stroke", "white")
                .style("stroke-width", "2px")
                .style("opacity", 1)


              u
                  .enter()
                  .append('text')
                  .text(function(d){ return d.data.key + ":" + d.data.value})
                  .attr("transform", function(d) { return "translate(" + arcGenerator.centroid(d) + ")";  })
                  .style("text-anchor", "middle")
                  .style("font-size", 17)
              // remove the group that is not present anymore
              } // PieChart Drawn
              update(sportList[0])

              var sportDropDown = d3.select("#selectTop3Sport")
                                     .selectAll("myoptions")
                                     .data(sportList)
                                     .enter()
                                     .append('option')
                                     .attr("pointer-events", "none")
                                     .text(function (d) { return d; }) // text showed in the menu
                                     .attr("value", function (d) { return d; }) // corresponding value returned by the button

    }

    // Handler for dropdown value change
     var dropdownChange = function() {
        var Sport = d3.select(this).property('value');
        console.log(Sport);
        //d3.selectAll("#pieChartLayoutTop3SportMedal>*").remove();
        update(Sport)
        //plotEventByYear(newYear);
      };

      var SportValue = d3.select("#selectTop3Sport").on("change",dropdownChange );
          ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  }

  </script>

  <script type="text/javascript" id="initialFunction">
  var countryList = ["Australia","Canada","China","France","Germany","Great Britain","Hungary","Italy","Japan","Netherlands","Poland","Russia","Spain","Sweden","United States"];
  var CountryDropDown = d3.select("#selectCountry")
                        .selectAll("myoptions")
                        .data(countryList)
                        .enter()
                        .append('option')
                        .attr("pointer-events", "none")
                        .text(function (d) { return d; }) // text showed in the menu
                        .attr("value", function (d) { return d; }) // corresponding value returned by the button

  window.dashboard("Australia");
  // Handler for dropdown value change
   var dropdownChange = function() {
      var Country = d3.select(this).property('value');
      console.log(Country);
      d3.selectAll("#OverallDashboard").remove();
      d3.selectAll("#Top3SportByCountryFullStats>*").remove();
      d3.selectAll("#pieChartLayoutTop3SportMedal>*").remove();
      d3.selectAll("#selectTop3Sport>*").remove();
      window.dashboard(Country)
      //plotEventByYear(newYear);
    };

    var CountryValue = d3.select("#selectCountry")
                    .on("change",dropdownChange );


    </script>

</body>
</html>
